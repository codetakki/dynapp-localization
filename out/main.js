var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var E=M((I,b)=>{var x=require("fs"),w=require("path"),u=require("vscode");function T(e){y(e)}function y(e){let t=v();u.window.showInputBox({prompt:"Enter the key name for the new message in "+w.basename(t)}).then(a=>{if(a){let n=`
`+a+"="+e;x.appendFile(t,n,l=>{if(l)u.window.showErrorMessage("Failed to add new entry to messages.properties");else{let s=u.window.activeTextEditor;s&&s.edit(d=>{s.selections.forEach(g=>{d.replace(g,`%{${a}}`)})}),u.window.showInformationMessage("New entry added to "+w.basename(t))}})}})}function v(){let e=u.window.activeTextEditor;if(!e)return null;u.workspace.workspaceFolders.forEach(l=>{});let t=u.workspace.getConfiguration("dynapp-localization").get("dataitempath")||"",a=u.workspace.getConfiguration("dynapp-localization").get("defaultlanguage")||"";var n="messages.properties";return a!==""&&(n=`messages_${a}.properties`),w.join(P(e)+t,n)}function P(e){if(!e)return null;let t=e.document,a=u.workspace.getWorkspaceFolder(t.uri);return a?a.uri.fsPath:null}function C(e,t=/%\{(.+)\}/g){let n=[...e.getText().matchAll(t)],l=[];for(let s of n){let d=e.positionAt(s.index),g=e.positionAt(s.index+s[0].length),o=new u.Range(d,g);l.push({text:s[0],range:o})}return l}function A(e){let t=e.match(/%\{(.+)\}/);if(t){let a=t[1],n=v(),s=x.readFileSync(n,"utf8").match(new RegExp(`^${a}=(.+)`,"m"));return s?s[1]:null}}b.exports={StartPlaceInMessage:T,getMatchingStrings:C,getValueFromMessages:A,getMessagesPath:v}});var i=require("vscode"),h=E(),V=require("fs"),F=require("path");function k(e){console.log('Congratulations, your extension "dynapp-localization" is now active!');let t=i.languages.registerCodeActionsProvider("*",{provideCodeActions(o,f){let r=new i.CodeAction("Run Command",i.CodeActionKind.Empty);return r.command={title:"Place in messages",command:"dynapp-localization.placeInMessage",arguments:[o,f]},[r]}});e.subscriptions.push(t);let a=i.commands.registerCommand("dynapp-localization.placeInMessage",(o,f)=>{let r=i.window.activeTextEditor,c=r.selection;if(c&&!c.isEmpty){let m=new i.Range(c.start.line,c.start.character,c.end.line,c.end.character),p=r.document.getText(m);p&&h.StartPlaceInMessage(p)}});e.subscriptions.push(a),e.subscriptions.push(i.languages.registerHoverProvider({scheme:"file"},{provideHover(o,f,r){let c=o.getWordRangeAtPosition(f,/%\{(.+)\}/);if(c){let m=o.getText(c),p=h.getValueFromMessages(m);if(p)return new i.Hover(`${F.basename(h.getMessagesPath())}: ${p}`)}}}));let n=i.window.activeTextEditor,l=[];function s(){if(!n)return;l.forEach(r=>{n.setDecorations(r,[])}),l=[];let o=n.document;h.getMatchingStrings(o).forEach(r=>{var c=h.getValueFromMessages(r.text)||"No value found";let m=i.window.createTextEditorDecorationType({after:{contentText:"."+c,color:i.workspace.getConfiguration("dynapp-localization").get("annotationcolor")||"rgba(110, 110, 110, 0.8"}});l.push(m);let p=[r.range];n.setDecorations(m,p)})}let d;function g(o=!1){d&&(clearTimeout(d),d=void 0),o?d=setTimeout(s,500):s()}n&&g(),i.window.onDidChangeActiveTextEditor(o=>{n=o,o&&g()},null,e.subscriptions),i.workspace.onDidChangeTextDocument(o=>{n&&o.document===n.document&&g(!0)},null,e.subscriptions)}function D(){}module.exports={activate:k,deactivate:D};
